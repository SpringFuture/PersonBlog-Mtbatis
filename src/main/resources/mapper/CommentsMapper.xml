<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.usy.personblog.mapper.CommentsMapper">
    <resultMap id="BaseResultMap" type="com.usy.personblog.models.Comment">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Oct 22 12:19:07 CST 2020.
        -->
        <id column="id" jdbcType="BIGINT" property="id" />
        <result column="avatar" jdbcType="VARCHAR" property="avatar" />
        <result column="content" jdbcType="VARCHAR" property="content" />
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
        <result column="email" jdbcType="VARCHAR" property="email" />
        <result column="nickname" jdbcType="VARCHAR" property="nickname" />
        <result column="blog_id" jdbcType="BIGINT" property="blogId" />
        <result column="parent_comment_id" jdbcType="BIGINT" property="parentCommentId" />
        <result column="admin_comment" jdbcType="BIT" property="adminComment" />
    </resultMap>
  <!--添加评论-->
  <insert id="saveComment" parameterType="com.usy.personblog.models.Comment">
        insert into t_comment (avatar,content,create_time,email,nickname,blog_id,parent_comment_id,admin_comment)
        values (#{avatar},#{content},#{createTime},#{email},#{nickname},#{blogId},#{parentCommentId},#{adminComment});
    </insert>

  <!--查询父级评论-->
  <select id="findByBlogIdNull" resultType="com.usy.personblog.models.Comment" resultMap="BaseResultMap">
        select *
        from t_comment c
        where c.blog_id = #{BlogId}
        and c.parent_comment_id= 0
        order by c.create_time desc
    </select>

  <!--查询一级回复-->
  <select id="findParentIdNotNull" resultType="com.usy.personblog.models.Comment" resultMap="BaseResultMap">
        select *
        from t_comment c
        where c.parent_comment_id = #{id}
        order by c.create_time desc
    </select>

  <!--查询二级以及所有子集回复-->
  <select id="findByReplayId" resultType="com.usy.personblog.models.Comment" resultMap="BaseResultMap">
        select *
        from t_comment c
        where c.parent_comment_id = #{childId}
        order by c.create_time desc
    </select>
</mapper>